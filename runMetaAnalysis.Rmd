# Meta-analysis

Load tidy data.

```{r}
f <- "AllStudies.RData"
load(f, verbose=TRUE)
metadata$timeStamp
metadata$colNames
```

Estimate pooled effects.

```{r}
domains <- unique(D[, cognitiveDomain])
n <- D[, .N, cognitiveDomain][, N]
models <- list()
for (i in 1:length(domains)) {
  models[[i]] <- rma(yi, vi, data=D[cognitiveDomain == domains[i]],
                     slab=sprintf("%s: %s", author, cognitiveTest))
  show(list(i = i, domain = domains[i], model = models[i]))
}
```

Save working data tables to file.

```{r}
metadata <- makeMetadata(D)
f <- "metaAnalysisCognitiveImpairment.RData"
save(D, metadataD, domains, models, file=f)
message(sprintf("%s saved on: %s\nFile size: %s KB", 
                f,
                file.mtime(f),
                file.size(f) / 1e3))
```


## Plots of effect sizes by domain

Forest plots.

```{r, echo=FALSE}
h <- sqrt(n) * 1.5
```

```{r, fig.width=10, fig.height=h[1]}
forest(models[[1]], main=domains[1])
```

```{r, fig.width=10, fig.height=h[2]}
forest(models[[2]], main=domains[2])
```

```{r, fig.width=10, fig.height=h[3]}
forest(models[[3]], main=domains[3])
```

```{r, fig.width=10, fig.height=h[4]}
forest(models[[4]], main=domains[4])
```

```{r, fig.width=10, fig.height=h[5]}
forest(models[[5]], main=domains[5])
```

```{r, fig.width=10, fig.height=h[6]}
forest(models[[6]], main=domains[6])
```

```{r, fig.width=10, fig.height=h[7]}
forest(models[[7]], main=domains[7])
```

```{r, fig.width=10, fig.height=h[8]}
forest(models[[8]], main=domains[8])
```
